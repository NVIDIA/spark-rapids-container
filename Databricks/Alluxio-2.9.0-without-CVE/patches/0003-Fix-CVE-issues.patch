From eba9d12d4c1652b33ba566b811af5577eef0ac1a Mon Sep 17 00:00:00 2001
From: Chong Gao <res_life@163.com>
Date: Fri, 16 Dec 2022 18:18:19 +0800
Subject: [PATCH 3/3] Fix CVE issues

---
 core/client/hdfs/pom.xml | 20 ++++++++------------
 examples/pom.xml         | 15 ++++++++-------
 2 files changed, 16 insertions(+), 19 deletions(-)

diff --git a/core/client/hdfs/pom.xml b/core/client/hdfs/pom.xml
index f73f290482..a360410aa8 100644
--- a/core/client/hdfs/pom.xml
+++ b/core/client/hdfs/pom.xml
@@ -40,12 +40,10 @@
       <artifactId>hadoop-client</artifactId>
       <exclusions>
         <exclusion>
-          <groupId>net.minidev</groupId>
-          <artifactId>json-smart</artifactId>
-        </exclusion>
-        <exclusion>
-          <groupId>com.fasterxml.woodstox</groupId>
-          <artifactId>woodstox-core</artifactId>
+          <!-- Fix CVE-2021-31684, refer to https://github.com/advisories/GHSA-fg2v-w576-w4v3 -->
+          <!-- nimbus-jose-jwt shades json-smart 1.3.2 into it -->
+          <groupId>com.nimbusds</groupId>
+          <artifactId>nimbus-jose-jwt</artifactId>
         </exclusion>
       </exclusions>
     </dependency>
@@ -62,12 +60,10 @@
       <version>${project.version}</version>
       <exclusions>
         <exclusion>
-          <groupId>net.minidev</groupId>
-          <artifactId>json-smart</artifactId>
-        </exclusion>
-        <exclusion>
-          <groupId>com.fasterxml.woodstox</groupId>
-          <artifactId>woodstox-core</artifactId>
+          <!-- Fix CVE-2021-31684, refer to https://github.com/advisories/GHSA-fg2v-w576-w4v3 -->
+          <!-- nimbus-jose-jwt shades json-smart 1.3.2 into it -->
+          <groupId>com.nimbusds</groupId>
+          <artifactId>nimbus-jose-jwt</artifactId>
         </exclusion>
       </exclusions>
     </dependency>
diff --git a/examples/pom.xml b/examples/pom.xml
index 4cb6bb2151..82c2cd09eb 100644
--- a/examples/pom.xml
+++ b/examples/pom.xml
@@ -50,13 +50,14 @@
     <dependency>
       <groupId>org.apache.hadoop</groupId>
       <artifactId>hadoop-client</artifactId>
-    </dependency>
-    <dependency>
-      <!-- Fix CVE: https://github.com/advisories/GHSA-fv22-xp26-mm9w -->
-      <!-- hadoop client/common 3.2.4/3.3.1 use woodstox-core 5.3.0 version which has CVE -->
-      <groupId>com.fasterxml.woodstox</groupId>
-      <artifactId>woodstox-core</artifactId>
-      <version>${woodstox-core.version}</version>
+      <exclusions>
+        <exclusion>
+          <!-- Fix CVE-2021-31684, refer to https://github.com/advisories/GHSA-fg2v-w576-w4v3 -->
+          <!-- nimbus-jose-jwt shades json-smart 1.3.2 into it -->
+          <groupId>com.nimbusds</groupId>
+          <artifactId>nimbus-jose-jwt</artifactId>
+        </exclusion>
+      </exclusions>
     </dependency>
     <dependency>
       <groupId>org.slf4j</groupId>
-- 
2.25.1

